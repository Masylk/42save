{"ast":null,"code":"var _jsxFileName = \"/home/mtogbe/42save/transcendence_box/pong/src/components/Ball.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState, useRef } from 'react';\nimport styled from 'styled-components';\nimport ballImg from '../img/Ball.png';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst BALL_RADIUS = 10;\nconst BALL_SIZE = BALL_RADIUS * 2;\nconst BASE_VELOCITY = 2;\nconst HEIGHT_OFFSET = 30;\nconst MAX_VELOCITY = 6;\nconst BOUNCE_ACCELERATION = 1.1;\nconst Ball = props => {\n  _s();\n  const [position, setPosition] = useState({\n    x: props.width / 2,\n    y: props.height / 2\n  });\n  const [velocity, setVelocity] = useState({\n    x: BASE_VELOCITY,\n    y: BASE_VELOCITY\n  });\n  const ballRef = useRef(null);\n  useEffect(() => {\n    if (props.socket !== null) {\n      socket.on('ball-move', pos => {\n        setPosition({\n          x: pos.x,\n          y: pos.y\n        });\n        console.log();\n      });\n    }\n  }, []);\n  useEffect(() => {\n    if (props.socket === null) {\n      let intervalId = setInterval(() => {\n        if (props.managerRef.current && props.managerRef.current.innerText === \"\") {\n          setPosition(prevPosition => ({\n            x: prevPosition.x + velocity.x,\n            y: prevPosition.y + velocity.y\n          }));\n        }\n      }, 4);\n      return () => clearInterval(intervalId);\n    }\n  }, [velocity, props.managerRef, props.height, props.width]);\n  const [isColliding, setIsColliding] = useState(false);\n  useEffect(() => {\n    if (props.socket === null) {\n      if (position.x <= 0 + 10 || position.x + BALL_SIZE >= props.width - 10) {\n        setVelocity(prevVelocity => ({\n          x: prevVelocity.x < 0 ? -BASE_VELOCITY : BASE_VELOCITY,\n          y: BASE_VELOCITY\n        }));\n        setPosition(prevPosition => ({\n          x: props.width / 2,\n          y: props.height / 2\n        }));\n        if (position.x <= 0 + 10) {\n          const currValue = parseInt(props.scoreRight.current.innerText);\n          props.scoreRight.current.innerText = currValue + 1 < 10 ? '0' + (currValue + 1) : currValue + 1;\n        } else {\n          const currValue = parseInt(props.scoreLeft.current.innerText);\n          props.scoreLeft.current.innerText = currValue + 1 < 10 ? '0' + (currValue + 1) : currValue + 1;\n        }\n      }\n      if (position.y <= 0 + HEIGHT_OFFSET || position.y + BALL_SIZE >= props.height - HEIGHT_OFFSET) {\n        if (!isColliding) {\n          setIsColliding(true);\n          setVelocity(prevVelocity => ({\n            x: prevVelocity.x,\n            y: -prevVelocity.y\n          }));\n        } else {\n          setIsColliding(false);\n        }\n      }\n    }\n    const ballRect = ballRef.current.getBoundingClientRect();\n    const checkCollision = (ballRect, characterRect) => {\n      if (ballRect.x + BALL_RADIUS > characterRect.x && ballRect.x - BALL_RADIUS < characterRect.x + characterRect.width && ballRect.y + BALL_RADIUS > characterRect.y && ballRect.y - BALL_RADIUS < characterRect.y + characterRect.height) return true;\n      return false;\n    };\n    const playerRect = props.playerRef.current && props.playerRef.current.getBoundingClientRect();\n    const opponentRect = props.opponentRef.current && props.opponentRef.current.getBoundingClientRect();\n    if (props.playerRef.current && checkCollision(ballRect, playerRect) || props.opponentRef.current && checkCollision(ballRect, opponentRect)) {\n      if (!isColliding) {\n        setIsColliding(true);\n        setVelocity(prevVelocity => ({\n          x: -(prevVelocity.x < 0 ? Math.max(prevVelocity.x * BOUNCE_ACCELERATION, -MAX_VELOCITY) : Math.min(prevVelocity.x * BOUNCE_ACCELERATION, MAX_VELOCITY)),\n          y: prevVelocity.y\n        }));\n      }\n    } else {\n      setIsColliding(false);\n    }\n  }, [position, props.playerRef, props.opponentRef, props.scoreLeft, props.scoreRight, props.height, props.width, isColliding]);\n  return /*#__PURE__*/_jsxDEV(BallDiv, {\n    ref: ballRef,\n    x: props.socket === null ? position.x : props.x,\n    y: props.socket === null ? position.y : props.y\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 119,\n    columnNumber: 7\n  }, this);\n};\n_s(Ball, \"Ee1Zvdd0DVXG0kwj0rwLJ3Miuws=\");\n_c = Ball;\nconst BallDiv = styled.div.attrs(props => ({\n  style: {\n    width: `${BALL_RADIUS * 2}px`,\n    height: `${BALL_RADIUS * 2}px`,\n    left: `${props.x - BALL_RADIUS}px`,\n    top: `${props.y - BALL_RADIUS}px`,\n    backgroundImage: `url(${ballImg})`\n  }\n}))`\nposition: absolute;\nbackground-size: cover;\nbackground-position: center;\n// border-radius: 50%;\n`;\n_c2 = BallDiv;\nexport default Ball;\nvar _c, _c2;\n$RefreshReg$(_c, \"Ball\");\n$RefreshReg$(_c2, \"BallDiv\");","map":{"version":3,"names":["React","useEffect","useState","useRef","styled","ballImg","jsxDEV","_jsxDEV","BALL_RADIUS","BALL_SIZE","BASE_VELOCITY","HEIGHT_OFFSET","MAX_VELOCITY","BOUNCE_ACCELERATION","Ball","props","_s","position","setPosition","x","width","y","height","velocity","setVelocity","ballRef","socket","on","pos","console","log","intervalId","setInterval","managerRef","current","innerText","prevPosition","clearInterval","isColliding","setIsColliding","prevVelocity","currValue","parseInt","scoreRight","scoreLeft","ballRect","getBoundingClientRect","checkCollision","characterRect","playerRect","playerRef","opponentRect","opponentRef","Math","max","min","BallDiv","ref","fileName","_jsxFileName","lineNumber","columnNumber","_c","div","attrs","style","left","top","backgroundImage","_c2","$RefreshReg$"],"sources":["/home/mtogbe/42save/transcendence_box/pong/src/components/Ball.js"],"sourcesContent":["import React, { useEffect, useState, useRef } from 'react';\r\nimport styled from 'styled-components';\r\nimport ballImg from '../img/Ball.png';\r\n\r\nconst BALL_RADIUS = 10;\r\nconst BALL_SIZE = BALL_RADIUS * 2;\r\nconst BASE_VELOCITY = 2;\r\nconst HEIGHT_OFFSET = 30;\r\nconst MAX_VELOCITY = 6;\r\nconst BOUNCE_ACCELERATION = 1.1;\r\n\r\nconst Ball = (props) => {\r\n    const [position, setPosition] = useState({\r\n      x: props.width / 2,\r\n      y: props.height / 2\r\n    });\r\n  \r\n    const [velocity, setVelocity] = useState({\r\n      x: BASE_VELOCITY,\r\n      y: BASE_VELOCITY\r\n    });\r\n  \r\n    const ballRef = useRef(null);\r\n\r\n    useEffect(() => {\r\n      if (props.socket !== null) {\r\n        socket.on('ball-move', (pos) => {\r\n          setPosition({\r\n            x: pos.x,\r\n            y: pos.y,\r\n          })\r\n          console.log()\r\n        })\r\n      }\r\n    }, [])\r\n\r\n    useEffect(() => {\r\n      if (props.socket === null) {\r\n        let intervalId = setInterval(() => {\r\n          if (props.managerRef.current && props.managerRef.current.innerText === \"\")\r\n          {\r\n              setPosition((prevPosition) => ({\r\n                x: prevPosition.x + velocity.x,\r\n                y: prevPosition.y + velocity.y\r\n              }));\r\n          }\r\n        }, 4);  \r\n        return () => clearInterval(intervalId);\r\n      }\r\n    }, [velocity, props.managerRef, props.height, props.width]);\r\n  \r\n    const [isColliding, setIsColliding] = useState(false);\r\n\r\n    useEffect(() => {\r\n        if (props.socket === null)\r\n        {\r\n          if (position.x <= 0 + 10 || position.x + BALL_SIZE >= props.width - 10) {\r\n            setVelocity((prevVelocity) => ({\r\n              x: prevVelocity.x < 0 ? -BASE_VELOCITY : BASE_VELOCITY,\r\n              y: BASE_VELOCITY\r\n            }));\r\n            setPosition((prevPosition) => ({\r\n              x : props.width / 2,\r\n              y: props.height / 2\r\n            }))\r\n            if (position.x <= 0 + 10)\r\n            {\r\n              const currValue = parseInt(props.scoreRight.current.innerText);\r\n              props.scoreRight.current.innerText = currValue + 1 < 10 ? '0' + (currValue + 1) : currValue + 1;\r\n            }\r\n            else\r\n            {\r\n              const currValue = parseInt(props.scoreLeft.current.innerText);\r\n              props.scoreLeft.current.innerText = currValue + 1 < 10 ? '0' + (currValue + 1) : currValue + 1;\r\n            }\r\n          }\r\n          if (position.y <= 0 + HEIGHT_OFFSET || position.y + BALL_SIZE >= props.height - HEIGHT_OFFSET) {\r\n            if (!isColliding) {\r\n              setIsColliding(true);\r\n              setVelocity((prevVelocity) => ({\r\n                  x: prevVelocity.x,\r\n                  y: -prevVelocity.y\r\n              }));\r\n          } else {\r\n            setIsColliding(false);\r\n          }\r\n        }\r\n      }\r\n      const ballRect = ballRef.current.getBoundingClientRect();\r\n      \r\n      const checkCollision = (ballRect, characterRect) => {\r\n        \r\n        if (ballRect.x + BALL_RADIUS > characterRect.x &&\r\n          ballRect.x - BALL_RADIUS < characterRect.x + characterRect.width &&\r\n          ballRect.y + BALL_RADIUS > characterRect.y &&\r\n          ballRect.y - BALL_RADIUS < characterRect.y + characterRect.height)\r\n          return (true)\r\n        return (false)\r\n      }\r\n\r\n      const playerRect = props.playerRef.current && props.playerRef.current.getBoundingClientRect();\r\n      const opponentRect = props.opponentRef.current && props.opponentRef.current.getBoundingClientRect();\r\n      if ((props.playerRef.current && checkCollision(ballRect, playerRect)) ||\r\n        (props.opponentRef.current && checkCollision(ballRect, opponentRect))) {\r\n        if (!isColliding) {\r\n          setIsColliding(true);\r\n          setVelocity((prevVelocity) => ({\r\n              x: -(prevVelocity.x < 0 ? (Math.max(prevVelocity.x * BOUNCE_ACCELERATION, -MAX_VELOCITY)) :\r\n                  Math.min(prevVelocity.x * BOUNCE_ACCELERATION, MAX_VELOCITY)),\r\n              y: prevVelocity.y\r\n          }));\r\n        }\r\n      } else {\r\n        setIsColliding(false);\r\n      }\r\n    }, [position, props.playerRef, props.opponentRef, props.scoreLeft, props.scoreRight, props.height, props.width, isColliding]);\r\n  \r\n    return (\r\n      <BallDiv ref={ballRef} x={props.socket === null ? position.x : props.x} y={props.socket === null ? position.y : props.y} />\r\n    );\r\n  };\r\n\r\nconst BallDiv = styled.div.attrs(props => ({\r\nstyle: {\r\n    width: `${BALL_RADIUS * 2}px`,\r\n    height: `${BALL_RADIUS * 2}px`,\r\n    left: `${props.x - BALL_RADIUS}px`,\r\n    top: `${props.y - BALL_RADIUS}px`,\r\n    backgroundImage: `url(${ballImg})`\r\n}\r\n}))`\r\nposition: absolute;\r\nbackground-size: cover;\r\nbackground-position: center;\r\n// border-radius: 50%;\r\n`;\r\n\r\nexport default Ball;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}